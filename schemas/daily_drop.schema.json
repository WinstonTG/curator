{
  "$ref": "#/definitions/DailyDropPackage",
  "definitions": {
    "DailyDropPackage": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid"
        },
        "user_id": {
          "type": "string",
          "format": "uuid"
        },
        "generated_at": {
          "type": "string",
          "format": "date-time"
        },
        "expires_at": {
          "type": "string",
          "format": "date-time"
        },
        "delivery_date": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
        },
        "version": {
          "type": "integer",
          "exclusiveMinimum": 0
        },
        "personalization": {
          "type": "object",
          "properties": {
            "preference_vectors_used": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uuid"
              }
            },
            "interests_matched": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uuid"
              }
            },
            "constraints_applied": {
              "type": "array",
              "items": {
                "type": "string",
                "format": "uuid"
              }
            },
            "diversity_score": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            },
            "exploration_ratio": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            }
          },
          "required": [
            "preference_vectors_used",
            "interests_matched",
            "constraints_applied",
            "diversity_score",
            "exploration_ratio"
          ],
          "additionalProperties": false
        },
        "sections": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "domain": {
                "type": "string",
                "enum": [
                  "music",
                  "news",
                  "recipes",
                  "learning",
                  "events"
                ]
              },
              "title": {
                "type": "string",
                "minLength": 1
              },
              "description": {
                "type": "string"
              },
              "items": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "item_id": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "rank": {
                      "type": "integer",
                      "exclusiveMinimum": 0
                    },
                    "score": {
                      "type": "number",
                      "minimum": 0,
                      "maximum": 1
                    },
                    "reasons": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "minItems": 1
                    },
                    "sponsored": {
                      "type": "boolean"
                    },
                    "explanation_type": {
                      "type": "string",
                      "enum": [
                        "interest_match",
                        "behavioral",
                        "similarity",
                        "trending",
                        "diversity",
                        "sponsored"
                      ]
                    }
                  },
                  "required": [
                    "item_id",
                    "rank",
                    "score",
                    "reasons",
                    "sponsored",
                    "explanation_type"
                  ],
                  "additionalProperties": false
                },
                "minItems": 1
              },
              "section_score": {
                "type": "number",
                "minimum": 0,
                "maximum": 1
              },
              "item_count": {
                "type": "integer",
                "minimum": 0
              }
            },
            "required": [
              "domain",
              "title",
              "items",
              "section_score",
              "item_count"
            ],
            "additionalProperties": false
          },
          "minItems": 1
        },
        "metadata": {
          "type": "object",
          "properties": {
            "total_items": {
              "type": "integer",
              "minimum": 0
            },
            "domains_included": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": [
                  "music",
                  "news",
                  "recipes",
                  "learning",
                  "events"
                ]
              },
              "minItems": 1
            },
            "generation_time_ms": {
              "type": "integer",
              "minimum": 0
            },
            "ranker_version": {
              "type": "string",
              "minLength": 1
            },
            "has_sponsored": {
              "type": "boolean"
            },
            "average_score": {
              "type": "number",
              "minimum": 0,
              "maximum": 1
            }
          },
          "required": [
            "total_items",
            "domains_included",
            "generation_time_ms",
            "ranker_version",
            "has_sponsored",
            "average_score"
          ],
          "additionalProperties": false
        }
      },
      "required": [
        "id",
        "user_id",
        "generated_at",
        "expires_at",
        "delivery_date",
        "version",
        "personalization",
        "sections",
        "metadata"
      ],
      "additionalProperties": false
    }
  },
  "$schema": "http://json-schema.org/draft-07/schema#"
}